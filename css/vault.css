        :root {
            --bg-deep: #1a0d1e;
            --rose-dark: #d4789a;
            --rose: #e8a0bb;
            --rose-light: #f4c4d8;
            --rose-glow: #fce4ef;
            --rose-pale: #fff0f6;
            --lavender: #d8b4e8;
            --text: #fdf0f8;
            --text-dim: #c8a8c0;
            --bubble-bg: rgba(34, 10, 40, 0.90);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        .vault-section {
            position: relative;
            /* Clave para que los hijos absolute no se escapen */
            overflow: hidden;
            /* Para que las cortinas no se vean fuera de la sección */
            min-height: 100vh;
            background: var(--bg-deep);
            width: 100%;
        }

        /* ── BACKGROUND ── */
        .bg-gradient {
            position: fixed;
            inset: 0;
            z-index: 1;
            pointer-events: none;
            background:
                radial-gradient(ellipse 70% 50% at 15% 15%, rgba(212, 120, 154, 0.13) 0%, transparent 60%),
                radial-gradient(ellipse 60% 70% at 85% 85%, rgba(180, 100, 200, 0.10) 0%, transparent 60%),
                radial-gradient(ellipse 50% 50% at 50% 50%, rgba(232, 160, 187, 0.06) 0%, transparent 70%);
        }

        .star {
            position: fixed;
            background: white;
            border-radius: 50%;
            pointer-events: none;
            z-index: 1;
            animation: starTwinkle ease-in-out infinite;
        }

        @keyframes starTwinkle {

            0%,
            100% {
                opacity: .15;
                transform: scale(1)
            }

            50% {
                opacity: .65;
                transform: scale(1.4)
            }
        }

        /* ── LAYOUT ── */
        #app {
            position: relative;
            z-index: 10;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 36px 20px 60px;
        }

        /* ── TITLE ── */
        .vault-title {
            font-family: 'Cinzel Decorative', serif;
            font-size: clamp(1.1rem, 3vw, 1.9rem);
            color: var(--rose-light);
            text-align: center;
            letter-spacing: 0.28em;
            margin-bottom: 6px;
            text-shadow: 0 0 18px var(--rose-dark), 0 0 40px rgba(212, 120, 154, 0.4);
            animation: titlePulse 3.5s ease-in-out infinite;
        }

        .vault-subtitle {
            font-family: 'Crimson Pro', serif;
            font-style: italic;
            font-size: clamp(0.8rem, 2vw, 1rem);
            color: var(--text-dim);
            text-align: center;
            letter-spacing: 0.14em;
            margin-bottom: 36px;
            opacity: 0.7;
        }

        @keyframes titlePulse {

            0%,
            100% {
                text-shadow: 0 0 18px var(--rose-dark), 0 0 40px rgba(212, 120, 154, 0.3)
            }

            50% {
                text-shadow: 0 0 28px var(--rose-light), 0 0 60px rgba(212, 120, 154, 0.5)
            }
        }

        /* ── LOCKS ── */
        .locks-container {
            display: flex;
            gap: clamp(6px, 1.8vw, 14px);
            margin-bottom: 44px;
            align-items: flex-end;
            justify-content: center;
            flex-wrap: wrap;
        }

        .lock-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            position: relative;
        }

        .lock-svg {
            width: clamp(42px, 6.5vw, 60px);
            height: clamp(52px, 7.5vw, 72px);
            filter: drop-shadow(0 0 6px rgba(212, 120, 154, 0.2));
            transition: filter 0.5s ease;
        }

        .lock-item.unlocked .lock-svg {
            filter: drop-shadow(0 0 12px var(--rose-glow)) drop-shadow(0 0 28px var(--rose));
            animation: lockBounce 0.65s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes lockBounce {
            0% {
                transform: scale(1) rotate(0)
            }

            30% {
                transform: scale(1.28) rotate(-12deg)
            }

            60% {
                transform: scale(0.94) rotate(6deg)
            }

            100% {
                transform: scale(1) rotate(0)
            }
        }

        /* Letter HIDDEN until unlocked */
        .lock-letter {
            font-family: 'Cinzel Decorative', serif;
            font-size: clamp(0.95rem, 2.2vw, 1.4rem);
            color: transparent;
            /* TOTALLY INVISIBLE */
            user-select: none;
            min-width: 1.4em;
            text-align: center;
            transition: all 0.6s ease;
        }

        .lock-item.unlocked .lock-letter {
            color: var(--rose-light);
            text-shadow: 0 0 14px var(--rose-glow), 0 0 30px var(--rose-dark);
            animation: letterReveal 0.85s ease forwards;
        }

        @keyframes letterReveal {
            0% {
                transform: scale(0) rotate(-180deg);
                opacity: 0
            }

            70% {
                transform: scale(1.25) rotate(8deg);
                opacity: 1
            }

            100% {
                transform: scale(1) rotate(0);
                opacity: 1
            }
        }

        /* ── CAT GUARDIAN ── */
        .guardian-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 26px;
            position: relative;
        }

        #cat-container {
            position: relative;
            width: 190px;
            height: 210px;
            margin-bottom: 14px;
        }

        .cat-glow {
            position: absolute;
            inset: -28px;
            background: radial-gradient(circle, rgba(232, 160, 187, 0.25) 0%, transparent 70%);
            border-radius: 50%;
            animation: catGlowAnim 2.5s ease-in-out infinite;
        }

        @keyframes catGlowAnim {

            0%,
            100% {
                opacity: .4;
                transform: scale(1)
            }

            50% {
                opacity: .9;
                transform: scale(1.12)
            }
        }

        #cat-svg {
            width: 190px;
            height: 210px;
            filter: drop-shadow(0 5px 26px rgba(212, 120, 154, 0.55));
            overflow: visible;
        }

        /* Ear twitch */
        #ear-left-group {
            transform-origin: 68px 52px;
        }

        #ear-right-group {
            transform-origin: 132px 52px;
        }

        .ear-twitch-l {
            animation: earTwitchL 7s ease-in-out infinite;
        }

        .ear-twitch-r {
            animation: earTwitchR 7s ease-in-out infinite .4s;
        }

        @keyframes earTwitchL {

            0%,
            85%,
            100% {
                transform: rotate(0)
            }

            90% {
                transform: rotate(-14deg)
            }

            95% {
                transform: rotate(4deg)
            }
        }

        @keyframes earTwitchR {

            0%,
            85%,
            100% {
                transform: rotate(0)
            }

            90% {
                transform: rotate(12deg)
            }

            95% {
                transform: rotate(-4deg)
            }
        }

        /* Tail wag */
        #tail-group {
            transform-origin: 148px 170px;
            animation: tailWag 2.9s ease-in-out infinite;
        }

        @keyframes tailWag {

            0%,
            100% {
                transform: rotate(0)
            }

            25% {
                transform: rotate(13deg)
            }

            75% {
                transform: rotate(-11deg)
            }
        }

        /* Body breathe */
        #body-group {
            transform-origin: 100px 152px;
            animation: breathe 3.3s ease-in-out infinite;
        }

        @keyframes breathe {

            0%,
            100% {
                transform: scaleY(1)
            }

            50% {
                transform: scaleY(1.03)
            }
        }

        /* Blush pulse */
        #blush-group {
            animation: blushPulse 2.6s ease-in-out infinite;
        }

        @keyframes blushPulse {

            0%,
            100% {
                opacity: .35
            }

            50% {
                opacity: .65
            }
        }

        /* Bow bob */
        #bow-group {
            transform-origin: 100px 58px;
            animation: bowBob 2.1s ease-in-out infinite;
        }

        @keyframes bowBob {

            0%,
            100% {
                transform: translateY(0) rotate(0)
            }

            50% {
                transform: translateY(-2.5px) rotate(2deg)
            }
        }

        /* Sparkles */
        .cat-sparkle {
            position: absolute;
            font-size: .9rem;
            pointer-events: none;
            animation: sparkleFloat ease-in-out infinite;
        }

        @keyframes sparkleFloat {

            0%,
            100% {
                opacity: 0;
                transform: translateY(0) scale(.5)
            }

            50% {
                opacity: 1;
                transform: translateY(-13px) scale(1)
            }
        }

        /* ── CAT NAME ── */
        .cat-name-tag {
            font-family: 'Cinzel Decorative', serif;
            font-size: .72rem;
            color: var(--rose-light);
            letter-spacing: .25em;
            text-shadow: 0 0 10px var(--rose-dark);
            opacity: .72;
            margin-top: -8px;
            margin-bottom: 16px;
        }

        /* ── SPEECH BUBBLE ── */
        .speech-bubble {
            position: relative;
            background: var(--bubble-bg);
            border: 1.5px solid rgba(212, 120, 154, 0.38);
            border-radius: 20px;
            padding: 16px 26px;
            max-width: 430px;
            min-width: 270px;
            min-height: 62px;
            text-align: center;
            box-shadow: 0 0 22px rgba(212, 120, 154, 0.15), inset 0 0 28px rgba(120, 40, 80, 0.1);
            backdrop-filter: blur(12px);
        }

        .speech-bubble::before {
            content: '';
            position: absolute;
            top: -13px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 13px solid transparent;
            border-right: 13px solid transparent;
            border-bottom: 13px solid rgba(212, 120, 154, 0.38);
        }

        .speech-bubble::after {
            content: '';
            position: absolute;
            top: -11px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 12px solid transparent;
            border-right: 12px solid transparent;
            border-bottom: 12px solid var(--bubble-bg);
        }

        #guardian-text {
            font-family: 'Crimson Pro', serif;
            font-size: 1.05rem;
            color: var(--text);
            line-height: 1.55;
            min-height: 1.55em;
        }

        .typing-cursor {
            display: inline-block;
            width: 2px;
            height: 1em;
            background: var(--rose-light);
            margin-left: 2px;
            vertical-align: middle;
            animation: blink 1s step-end infinite;
        }

        @keyframes blink {

            0%,
            100% {
                opacity: 1
            }

            50% {
                opacity: 0
            }
        }

        /* ── INPUT ── */
        .input-zone {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 14px;
            width: 100%;
            max-width: 460px;
        }

        .input-row {
            display: flex;
            gap: 10px;
            width: 100%;
            align-items: center;
        }

        #code-input {
            flex: 1;
            background: rgba(18, 6, 24, 0.78);
            border: 1.5px solid rgba(212, 120, 154, 0.32);
            border-radius: 14px;
            padding: 13px 20px;
            font-family: 'Space Mono', monospace;
            font-size: .95rem;
            color: var(--rose-glow);
            letter-spacing: .1em;
            outline: none;
            transition: all .3s ease;
            box-shadow: 0 0 10px rgba(212, 120, 154, 0.08), inset 0 2px 8px rgba(0, 0, 0, 0.45);
            text-align: center;
        }

        #code-input:focus {
            border-color: var(--rose);
            box-shadow: 0 0 22px rgba(232, 160, 187, 0.28), inset 0 2px 8px rgba(0, 0, 0, 0.45);
        }

        #code-input::placeholder {
            color: var(--text-dim);
            opacity: .4;
        }

        #code-input.shake {
            animation: shake .5s cubic-bezier(.36, .07, .19, .97) both;
            border-color: #ff8aaa;
        }

        #code-input.correct {
            border-color: var(--rose-glow);
            box-shadow: 0 0 28px rgba(252, 228, 239, 0.45);
        }

        @keyframes shake {

            10%,
            90% {
                transform: translateX(-2px)
            }

            20%,
            80% {
                transform: translateX(4px)
            }

            30%,
            50%,
            70% {
                transform: translateX(-5px)
            }

            40%,
            60% {
                transform: translateX(5px)
            }
        }

        .btn-submit {
            background: linear-gradient(135deg, rgba(212, 120, 154, 0.8), rgba(232, 160, 187, 0.85));
            border: none;
            border-radius: 14px;
            padding: 13px 20px;
            color: var(--rose-pale);
            font-family: 'Space Mono', monospace;
            font-size: .85rem;
            cursor: pointer;
            transition: all .3s ease;
            box-shadow: 0 0 14px rgba(212, 120, 154, 0.22);
            white-space: nowrap;
        }

        .btn-submit:hover {
            background: linear-gradient(135deg, rgba(232, 160, 187, .9), rgba(252, 228, 239, .9));
            box-shadow: 0 0 24px rgba(232, 160, 187, .38);
            transform: translateY(-2px);
        }

        .btn-submit:active {
            transform: translateY(0);
        }

        /* ── INFO BUTTON ── */
        .btn-info {
            position: fixed;
            bottom: 22px;
            right: 22px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(20, 6, 26, .9);
            border: 1.5px solid rgba(212, 120, 154, .32);
            color: var(--rose-light);
            font-family: 'Cinzel Decorative', serif;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 18px rgba(212, 120, 154, .18);
            transition: all .3s ease;
        }

        .btn-info:hover {
            border-color: var(--rose);
            box-shadow: 0 0 28px rgba(232, 160, 187, .32);
            transform: scale(1.1);
        }

        /* ── MODAL ── */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(8, 2, 12, .82);
            z-index: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity .4s ease;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.visible {
            opacity: 1;
            pointer-events: all;
        }

        .modal-box {
            background: linear-gradient(160deg, rgba(26, 8, 34, .98), rgba(16, 4, 22, .98));
            border: 1.5px solid rgba(212, 120, 154, .28);
            border-radius: 22px;
            padding: 36px 40px;
            max-width: 480px;
            width: 90%;
            position: relative;
            box-shadow: 0 0 40px rgba(212, 120, 154, .18), inset 0 0 50px rgba(120, 40, 80, .07);
            transform: scale(.9) translateY(20px);
            transition: transform .4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .modal-overlay.visible .modal-box {
            transform: scale(1) translateY(0);
        }

        .modal-title {
            font-family: 'Cinzel Decorative', serif;
            font-size: 1.15rem;
            color: var(--rose-light);
            text-align: center;
            margin-bottom: 18px;
            text-shadow: 0 0 14px var(--rose-dark);
        }

        .modal-text {
            font-family: 'Crimson Pro', serif;
            font-size: 1.05rem;
            color: var(--text);
            line-height: 1.85;
            text-align: center;
        }

        .modal-text strong {
            color: var(--rose-glow);
            font-style: italic;
        }

        .modal-close {
            position: absolute;
            top: 12px;
            right: 16px;
            background: none;
            border: none;
            color: var(--text-dim);
            font-size: 1.35rem;
            cursor: pointer;
            transition: color .2s;
        }

        .modal-close:hover {
            color: var(--rose-light);
        }

        /* ── INFO BUTTON ── */
        .btn-info {
            position: absolute;
            bottom: 22px;
            left: 22px;
            /* Cambiado de right a left */
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(20, 6, 26, .9);
            border: 1.5px solid rgba(212, 120, 154, .32);
            color: var(--rose-light);
            font-family: 'Cinzel Decorative', serif;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 18px rgba(212, 120, 154, .18);
            transition: all .3s ease;
        }

        .btn-info:hover {
            border-color: var(--rose);
            box-shadow: 0 0 28px rgba(212, 120, 154, .32);
            transform: scale(1.08);
        }

        .btn-info:active {
            transform: scale(0.96);
        }

        /* ── OPEN CHEST BUTTON ── */
        .btn-open-chest {
            display: none;
            margin: 30px auto 20px;
            padding: 16px 40px;
            background: linear-gradient(135deg, rgba(212, 120, 154, 0.85), rgba(232, 160, 187, 0.9));
            border: 2px solid rgba(252, 228, 239, 0.4);
            border-radius: 20px;
            color: var(--rose-pale);
            font-family: 'Cinzel Decorative', serif;
            font-size: 1.1rem;
            cursor: pointer;
            box-shadow: 0 0 30px rgba(212, 120, 154, 0.4), inset 0 0 20px rgba(255, 255, 255, 0.1);
            transition: all 0.4s ease;
            animation: pulseGlow 2s ease-in-out infinite;
            letter-spacing: 0.1em;
        }

        .btn-open-chest:hover {
            background: linear-gradient(135deg, rgba(232, 160, 187, 0.95), rgba(252, 228, 239, 0.95));
            box-shadow: 0 0 50px rgba(232, 160, 187, 0.6), inset 0 0 30px rgba(255, 255, 255, 0.2);
            transform: translateY(-3px) scale(1.05);
        }

        .btn-open-chest:active {
            transform: translateY(0) scale(0.98);
        }

        @keyframes pulseGlow {

            0%,
            100% {
                box-shadow: 0 0 30px rgba(212, 120, 154, 0.4), inset 0 0 20px rgba(255, 255, 255, 0.1);
            }

            50% {
                box-shadow: 0 0 50px rgba(232, 160, 187, 0.6), inset 0 0 30px rgba(255, 255, 255, 0.15);
            }
        }

        /* ── PARTICLES ── */
        .particle {
            position: fixed;
            pointer-events: none;
            z-index: 5;
            border-radius: 50%;
            animation: particleFall linear forwards;
        }

        @keyframes particleFall {
            0% {
                transform: translateY(-20px) rotate(0);
                opacity: .7
            }

            100% {
                transform: translateY(102vh) rotate(720deg);
                opacity: 0
            }
        }

        .heart-particle {
            position: fixed;
            pointer-events: none;
            z-index: 6;
            animation: heartFloat 1.6s ease-out forwards;
        }

        @keyframes heartFloat {
            0% {
                transform: translateY(0) scale(0);
                opacity: 1
            }

            50% {
                transform: translateY(-65px) scale(1.2);
                opacity: 1
            }

            100% {
                transform: translateY(-130px) scale(.4);
                opacity: 0
            }
        }

        .unlock-flash {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 50;
            background: radial-gradient(circle, rgba(252, 228, 239, .26) 0%, transparent 70%);
            animation: flashIn .7s ease forwards;
        }

        @keyframes flashIn {
            0% {
                opacity: 0
            }

            15% {
                opacity: 1
            }

            100% {
                opacity: 0
            }
        }

        /* ── PROGRESS ── */
        .progress-text {
            font-family: 'Space Mono', monospace;
            font-size: .72rem;
            color: var(--text-dim);
            letter-spacing: .2em;
            text-align: center;
            opacity: .42;
            margin-top: -36px;
            margin-bottom: 14px;
        }

        /* ── CORNERS ── */
        .corner-deco {
            position: fixed;
            font-size: 1.4rem;
            opacity: .11;
            pointer-events: none;
            z-index: 2;
            animation: cornerFloat 4s ease-in-out infinite;
        }

        .corner-deco.tl {
            top: 18px;
            left: 18px;
            animation-delay: 0s
        }

        .corner-deco.tr {
            top: 18px;
            right: 18px;
            animation-delay: 1s
        }

        .corner-deco.bl {
            bottom: 18px;
            left: 18px;
            animation-delay: 2s
        }

        .corner-deco.br {
            bottom: 18px;
            right: 18px;
            animation-delay: 3s
        }

        @keyframes cornerFloat {

            0%,
            100% {
                transform: translateY(0) rotate(0)
            }

            50% {
                transform: translateY(-8px) rotate(8deg)
            }
        }

        /* ── FINAL LETTER ── */
        #letter-screen {
            position: fixed;
            inset: 0;
            background: var(--bg-deep);
            z-index: 200;
            display: flex;
            /* Keep flex for easy centering */
            /* Removed align-items: center to allow scroll on overflow */
            opacity: 0;
            pointer-events: none;
            transition: opacity 1.6s ease;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        #letter-screen.visible {
            opacity: 1;
            pointer-events: all;
        }

        .letter-container {
            max-width: 700px;
            width: 92%;
            margin: auto;
            /* Vertically and horizontally center if space allows, else scroll */
            padding: 60px 20px 100px 20px;
            /* Extra bottom padding */
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 28px;
        }

        .letter-roses {
            font-size: 2.2rem;
            text-align: center;
            animation: roseFloat 3s ease-in-out infinite;
            letter-spacing: .3em;
        }

        @keyframes roseFloat {

            0%,
            100% {
                transform: translateY(0)
            }

            50% {
                transform: translateY(-8px)
            }
        }

        .letter-paper {
            background: linear-gradient(160deg, rgba(26, 8, 34, .97), rgba(16, 4, 22, .98));
            border: 1.5px solid rgba(212, 120, 154, .22);
            border-radius: 26px;
            padding: 52px 50px;
            position: relative;
            /* overflow: hidden; Removed to allow content to flow naturally */
            box-shadow: 0 0 60px rgba(212, 120, 154, .18), inset 0 0 80px rgba(100, 20, 60, .07);
        }

        .letter-paper::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(ellipse at center, rgba(232, 160, 187, .03) 0%, transparent 60%);
            animation: paperShimmer 7s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes paperShimmer {

            0%,
            100% {
                transform: rotate(0)
            }

            50% {
                transform: rotate(180deg)
            }
        }

        .letter-greeting {
            font-family: 'Cinzel Decorative', serif;
            font-size: clamp(1rem, 2.8vw, 1.5rem);
            color: var(--rose-light);
            text-align: center;
            margin-bottom: 28px;
            text-shadow: 0 0 18px var(--rose-dark);
            opacity: 0;
            animation: fadeUp 1s ease .5s forwards;
        }

        .letter-body {
            font-family: 'Crimson Pro', serif;
            font-size: clamp(1rem, 2.4vw, 1.2rem);
            color: var(--text);
            line-height: 2.1;
            text-align: center;
            opacity: 0;
            animation: fadeUp 1s ease 1s forwards;
        }

        .letter-body em {
            color: var(--rose-pale);
            font-style: italic;
        }

        .letter-body strong {
            color: var(--rose-glow);
            font-weight: 400;
            font-style: italic;
        }

        .letter-body p {
            margin-bottom: 18px;
        }

        .letter-signature {
            font-family: 'Cinzel Decorative', serif;
            font-size: clamp(.85rem, 2vw, 1.1rem);
            color: var(--rose-light);
            text-align: center;
            margin-top: 28px;
            opacity: 0;
            animation: fadeUp 1s ease 1.5s forwards;
        }

        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(18px)
            }

            to {
                opacity: 1;
                transform: translateY(0)
            }
        }

        .letter-divider {
            width: 110px;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--rose-dark), transparent);
            margin: 18px auto;
        }

        /* ── FIREWORKS ── */
        #fireworks-canvas {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 150;
        }

        @media(max-width:480px) {
            .letter-paper {
                padding: 28px 22px
            }

            .modal-box {
                padding: 26px 22px
            }
        }

        /* ══════════════════════════════════════════════════════════════ */
        /*   WELCOME SCREEN                                                */
        /* ══════════════════════════════════════════════════════════════ */
        #welcome-screen {
            position: absolute;
            /* Changed from fixed to absolute */
            inset: 0;
            z-index: 9999;
            background: linear-gradient(160deg, #5d4c62 0%, #8e5c9b 50%, #dbafe8 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 1;
            transition: opacity 1.2s ease;
        }

        #welcome-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        /* Animated background particles for welcome */
        .welcome-bg {
            position: absolute;
            inset: 0;
            overflow: hidden;
            z-index: 1;
        }

        .welcome-particle {
            position: absolute;
            border-radius: 50%;
            animation: welcomeParticleFloat linear infinite;
        }

        @keyframes welcomeParticleFloat {
            0% {
                transform: translateY(0) rotate(0) scale(1);
                opacity: 0;
            }

            10% {
                opacity: 0.6;
            }

            90% {
                opacity: 0.4;
            }

            100% {
                transform: translateY(-100vh) rotate(360deg) scale(1.5);
                opacity: 0;
            }
        }

        /* Glowing orb background effect */
        .welcome-glow-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            animation: orbPulse 8s ease-in-out infinite;
        }

        @keyframes orbPulse {

            0%,
            100% {
                transform: scale(1) translate(-50%, -50%);
                opacity: 0.3;
            }

            50% {
                transform: scale(1.3) translate(-50%, -50%);
                opacity: 0.6;
            }
        }

        /* Welcome content container */
        .welcome-content {
            position: relative;
            z-index: 10;
            text-align: center;
            animation: welcomeContentIn 1.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }

        @keyframes welcomeContentIn {
            0% {
                opacity: 0;
                transform: scale(0.8) translateY(30px);
            }

            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* Welcome title */
        .welcome-title {
            font-family: 'Cinzel Decorative', serif;
            font-size: clamp(1.8rem, 5vw, 3.5rem);
            color: var(--rose-light);
            letter-spacing: 0.35em;
            margin-bottom: 16px;
            text-shadow:
                0 0 20px var(--rose-glow),
                0 0 40px var(--rose),
                0 0 80px rgba(232, 160, 187, 0.4);
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {

            0%,
            100% {
                text-shadow:
                    0 0 20px var(--rose-glow),
                    0 0 40px var(--rose),
                    0 0 80px rgba(232, 160, 187, 0.3);
            }

            50% {
                text-shadow:
                    0 0 30px var(--rose-glow),
                    0 0 60px var(--rose-light),
                    0 0 120px rgba(232, 160, 187, 0.5);
            }
        }

        /* Welcome subtitle */
        .welcome-subtitle {
            font-family: 'Crimson Pro', serif;
            font-size: clamp(1rem, 2.5vw, 1.4rem);
            font-style: italic;
            color: var(--text-dim);
            letter-spacing: 0.2em;
            margin-bottom: 50px;
            opacity: 0;
            animation: subtitleFadeIn 1s ease 0.5s forwards;
        }

        @keyframes subtitleFadeIn {
            to {
                opacity: 0.8;
            }
        }

        /* Welcome button */
        .btn-enter {
            position: relative;
            font-family: 'Cinzel Decorative', serif;
            font-size: clamp(1rem, 2.2vw, 1.3rem);
            letter-spacing: 0.3em;
            color: var(--rose-pale);
            background: linear-gradient(135deg, rgba(212, 120, 154, 0.3), rgba(232, 160, 187, 0.4));
            border: 2px solid var(--rose);
            border-radius: 50px;
            padding: 18px 50px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow:
                0 0 30px rgba(212, 120, 154, 0.3),
                inset 0 0 20px rgba(232, 160, 187, 0.1);
            opacity: 0;
            animation: buttonFadeIn 1s ease 1s forwards, buttonPulse 2s ease-in-out 2s infinite;
            overflow: hidden;
        }

        @keyframes buttonFadeIn {
            to {
                opacity: 1;
            }
        }

        @keyframes buttonPulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }
        }

        .btn-enter::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(252, 228, 239, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }

        .btn-enter:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-enter:hover {
            transform: translateY(-4px) scale(1.08);
            border-color: var(--rose-glow);
            background: linear-gradient(135deg, rgba(212, 120, 154, 0.5), rgba(232, 160, 187, 0.6));
            box-shadow:
                0 0 50px rgba(232, 160, 187, 0.6),
                0 10px 40px rgba(212, 120, 154, 0.3),
                inset 0 0 30px rgba(252, 228, 239, 0.2);
        }

        .btn-enter:active {
            transform: translateY(-2px) scale(1.05);
        }

        .btn-enter span {
            position: relative;
            z-index: 2;
        }

        /* Floating hearts on welcome screen */
        .welcome-heart {
            position: absolute;
            font-size: clamp(1.2rem, 3vw, 2rem);
            animation: welcomeHeartFloat linear infinite;
            pointer-events: none;
            opacity: 0;
        }

        @keyframes welcomeHeartFloat {
            0% {
                opacity: 0;
                transform: translateY(0) rotate(0) scale(0.5);
            }

            10% {
                opacity: 0.7;
            }

            90% {
                opacity: 0.4;
            }

            100% {
                opacity: 0;
                transform: translateY(-100vh) rotate(180deg) scale(1);
            }
        }

        /* Curtain reveal animation */
        .curtain-left,
        .curtain-right {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 50%;
            z-index: 9998;
            background: linear-gradient(to bottom,
                    rgba(26, 13, 30, 1) 0%,
                    rgba(42, 18, 48, 1) 50%,
                    rgba(26, 13, 30, 1) 100%);
            transition: transform 1.5s cubic-bezier(0.76, 0, 0.24, 1);
        }

        .curtain-left {
            left: 0;
            box-shadow: 10px 0 60px rgba(0, 0, 0, 0.8);
        }

        .curtain-right {
            right: 0;
            box-shadow: -10px 0 60px rgba(0, 0, 0, 0.8);
        }

        .curtain-left.open {
            transform: translateX(-100%);
        }

        .curtain-right.open {
            transform: translateX(100%);
        }

        /* Sparkle burst when entering */
        .sparkle-burst {
            position: absolute;
            pointer-events: none;
            z-index: 9997;
            font-size: 1.5rem;
            animation: sparkleBurstAnim 1.5s ease-out forwards;
        }

        @keyframes sparkleBurstAnim {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0) rotate(0deg);
            }

            30% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.5) rotate(180deg);
            }

            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.3) rotate(360deg);
            }
        }

        /* ══════════════════════════════════════════════════════════════ */
        /* FINAL LETTER SCREEN */
        /* ══════════════════════════════════════════════════════════════ */

        #letter-screen {
            position: fixed;
            inset: 0;
            background: rgba(26, 13, 30, 0.95);
            backdrop-filter: blur(10px);
            z-index: 200;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 1.6s ease;
            overflow-y: auto;
            padding: 20px;
        }

        #letter-screen.visible {
            opacity: 1;
            pointer-events: all;
        }

        .letter-close-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: rgba(20, 6, 26, .9);
            border: 1.5px solid rgba(212, 120, 154, .32);
            color: var(--rose-light);
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 201;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all .3s ease;
            opacity: 0;
            animation: fadeIn 0.5s ease 1s forwards;
        }

        .letter-close-btn:hover {
            border-color: var(--rose);
            background: rgba(30, 10, 36, .95);
            transform: scale(1.1) rotate(90deg);
        }

        .letter-container {
            max-width: 650px;
            /* Reduced from 750px for more vertical layout */
            width: 85%;
            /* Reduced from 90% */
            max-height: 95vh;
            /* Increased to cover almost full screen */
            /* Increased from 85vh for more height */
            overflow-y: visible;
            /* Changed from scroll - container no longer scrolls */
            padding: 25px 15px;
            /* Reduced vertical padding for more content space */
            /* Reduced for more vertical layout */
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            /* Reduced gap for more vertical space */
        }

        /* Custom scrollbar for webkit browsers */
        /* These rules are no longer needed as the container itself doesn't scroll */
        /* .letter-container::-webkit-scrollbar {
            width: 14px;
        }

        .letter-container::-webkit-scrollbar-track {
            background: rgba(26, 13, 30, 0.5);
            border-radius: 10px;
            margin: 10px 0;
        }

        .letter-container::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, rgba(232, 160, 187, 0.8), rgba(212, 120, 154, 0.8));
            border-radius: 10px;
            border: 2px solid rgba(26, 13, 30, 0.5);
            box-shadow: 0 0 10px rgba(232, 160, 187, 0.4);
        }

        .letter-container::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, rgba(252, 228, 239, 0.9), rgba(232, 160, 187, 0.9));
            box-shadow: 0 0 15px rgba(232, 160, 187, 0.6);
        } */

        .letter-roses {
            font-size: 2.2rem;
            text-align: center;
            animation: roseFloat 3s ease-in-out infinite;
            letter-spacing: .3em;
        }

        @keyframes roseFloat {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-8px);
            }
        }

        .letter-paper {
            background: linear-gradient(160deg, rgba(26, 8, 34, .97), rgba(16, 4, 22, .98));
            border: 1.5px solid rgba(212, 120, 154, .22);
            border-radius: 26px;
            padding: 55px 45px;
            /* More vertical padding, less horizontal */
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 60px rgba(212, 120, 154, .18), inset 0 0 80px rgba(100, 20, 60, .07);
            width: 100%;
        }

        .letter-paper::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(ellipse at center, rgba(232, 160, 187, .03) 0%, transparent 60%);
            animation: paperShimmer 7s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes paperShimmer {

            0%,
            100% {
                transform: rotate(0);
            }

            50% {
                transform: rotate(180deg);
            }
        }

        .letter-greeting {
            font-family: 'Cinzel Decorative', serif;
            font-size: clamp(1.4rem, 3.2vw, 1.9rem);
            color: var(--rose-light);
            text-align: center;
            margin-bottom: 35px;
            text-shadow: 0 0 18px var(--rose-dark);
            opacity: 0;
            animation: fadeUp 1s ease .5s forwards;
        }

        .letter-body {
            font-family: 'Crimson Pro', serif;
            font-size: clamp(1.15rem, 2.6vw, 1.3rem);
            color: var(--text);
            line-height: 1.75;
            text-align: center;
            opacity: 0;
            animation: fadeUp 1s ease 1s forwards;
            /* Add scroll to body only */
            max-height: 75vh;
            /* Increased to 75vh for better visibility on all screens */
            overflow-y: scroll;
            padding-right: 15px;
            padding-bottom: 400px;
            /* Massive padding to guarantee visibility */
            /* Hide scrollbar but keep functionality */
            scrollbar-width: none;
            /* Firefox */
            -ms-overflow-style: none;
            /* IE and Edge */
        }

        /* Hide scrollbar for webkit browsers */
        .letter-body::-webkit-scrollbar {
            display: none;
        }

        /* Arrow navigation buttons */
        .letter-scroll-btn {
            position: absolute;
            right: 20px;
            width: 38px;
            height: 38px;
            border-radius: 50%;
            background: rgba(212, 120, 154, 0.2);
            border: 1.5px solid rgba(212, 120, 154, 0.5);
            color: var(--rose-light);
            font-size: 1rem;
            cursor: pointer;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            opacity: 0;
            animation: fadeIn 0.5s ease 1.8s forwards;
        }

        .letter-scroll-btn:hover {
            background: rgba(232, 160, 187, 0.4);
            border-color: var(--rose);
            transform: scale(1.15);
            box-shadow: 0 0 20px rgba(232, 160, 187, 0.5);
        }

        .letter-scroll-btn:active {
            transform: scale(0.95);
        }

        .letter-scroll-up {
            top: 15px;
            /* Moved higher to not cover text */
        }

        .letter-scroll-down {
            bottom: 15px;
            /* Moved lower to not cover text */
        }

        .letter-body em {
            color: var(--rose-pale);
            font-style: italic;
        }

        .letter-body strong {
            color: var(--rose-glow);
            font-weight: 400;
            font-style: italic;
        }

        .letter-body p {
            margin-bottom: 10px;
            /* Reduced to 10px for maximum content visibility */
            /* Reduced from 20px for more content visibility */
        }

        .letter-signature {
            font-family: 'Cinzel Decorative', serif;
            font-size: clamp(1rem, 2.2vw, 1.25rem);
            color: var(--rose-light);
            text-align: center;
            margin-top: 32px;
            opacity: 0;
            animation: fadeUp 1s ease 1.5s forwards;
        }

        .letter-divider {
            width: 130px;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--rose-dark), transparent);
            margin: 24px auto;
            opacity: 0;
            animation: fadeIn 1s ease 1.2s forwards;
        }

        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(18px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        /* Responsive adjustments for letter */
        @media (max-width: 768px) {
            .letter-paper {
                padding: 30px 20px;
            }

            .letter-container {
                padding: 20px 10px;
            }
        }